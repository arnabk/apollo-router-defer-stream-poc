# Apollo Router v2 Configuration
# https://www.apollographql.com/docs/router/configuration/overview

# @defer and @stream support
# Both are enabled by default in Router v2, but we can configure them
supergraph:
  # Defer is enabled by default
  defer_support: true

# CORS configuration (v2 format - policy-based)
cors:
  policies:
    - origins:
        - http://localhost:3000
      allow_credentials: false
      allow_headers:
        - content-type
        - apollo-require-preflight

# Logging configuration
telemetry:
  instrumentation:
    spans:
      mode: spec_compliant
  
# Plugin configuration
plugins:
  experimental.expose_query_plan: true

# Traffic shaping
traffic_shaping:
  all:
    # Timeout for all requests
    timeout: 30s
  
  # Subgraph specific configuration
  subgraphs:
    products:
      timeout: 30s
